# IndependentWork13  
## Тема: Використання політик Polly для підвищення відмовостійкості  

## Мета роботи  
Дослідити застосування бібліотеки Polly у .NET для реалізації політик Retry, Circuit Breaker та Timeout, а також проаналізувати сценарії, у яких ці механізми підвищують стабільність роботи застосунків.

## Використані матеріали  
Polly GitHub Repository  
Polly Wiki: Retry Policy  
Polly Wiki: Circuit Breaker Policy  
Polly Wiki: Timeout Policy  
Microsoft Docs: Resilient Applications with Polly  
Навчальні матеріали Google Classroom  


# Сценарій 1. Виклик зовнішнього API з політикою Retry

### Опис проблеми  
Зовнішні API можуть тимчасово бути недоступними через мережеві збої або надмірне навантаження. У таких випадках операцію доцільно повторити кілька разів, оскільки проблема часто є короткочасною.

### Обґрунтування вибору політики  
Політика Retry дозволяє автоматично повторити операцію з паузами між спробами.  
Для даного сценарію використана експоненційна затримка (2, 4, 8 секунд), що зменшує навантаження на сервер та збільшує шанс успішного виконання.

### Імітація та реалізація  
Було розроблено метод, що двічі повертає помилку HttpRequestException, а на третій спробі успішно повертає дані.  
Polly виконує повторні спроби згідно із заданою політикою.

### Очікувана поведінка  
У логах відображаються перші невдалі виклики, повторні спроби з відповідними затримками та фінальний успішний виклик.  
Якщо всі спроби вичерпано, виводиться відповідне повідомлення про помилку.


# Сценарій 2. Нестабільне підключення до бази даних із використанням Circuit Breaker

### Опис проблеми  
База даних може тимчасово не відповідати. Без механізмів стримування застосунок може надсилати багато невдалих запитів поспіль, що лише погіршить ситуацію та перевантажить систему.

### Обґрунтування вибору політики  
Circuit Breaker переводить операції у "відкритий" стан після кількох помилок підряд, блокуючи подальші запити на визначений час.  
Це дозволяє стабілізувати ресурс і уникнути зайвого навантаження.

### Імітація та реалізація  
Було змодельовано три послідовні помилки при спробі підключення.  
Після двох помилок поспіль схема переходить у відкритий стан на 5 секунд, під час яких операції блокуються.

### Очікувана поведінка  
У логах видно:  
- момент відкриття схеми;  
- блокування наступних спроб;  
- повернення до нормальної роботи після закінчення часу очікування.


# Сценарій 3. Довга операція з обмеженням часу через Timeout Policy

### Опис проблеми  
Довгі операції можуть блокувати роботу застосунку або перевищувати допустиме очікування для користувача чи системи.

### Обґрунтування вибору політики  
Timeout Policy дозволяє встановити максимальний час виконання операції.  
Якщо він перевищений, операція завершується примусово з відповідною помилкою.

### Імітація та реалізація  
Було створено метод, що виконується 4 секунди, але політика встановлює таймаут у 2 секунди.

### Очікувана поведінка  
Операція переривається через перевищення дозволеного часу.  
У логах відображається факт спрацювання таймауту та завершення операції з винятком.


# Загальні висновки

1. Використання Polly значно підвищує надійність застосунків, що працюють із зовнішніми або нестабільними ресурсами.  
2. Політика Retry ефективно компенсує короткочасні збої та дає змогу уникнути помилок без втручання користувача.  
3. Circuit Breaker запобігає надмірному навантаженню на систему під час багаторазових помилок.  
4. Timeout гарантує, що операції не будуть виконуватися довше, ніж дозволено вимогами системи.  
5. Комбінація цих політик забезпечує більш стійку архітектуру та підвищує загальну відмовостійкість .NET-застосунків.